# configuration file for the setup for integration testing: inl-csu-usc-nrel
# Test with acs-rtds (nrel), acs-opal1 (csu), acs-opal2 (usc)
#
# host: inl-villas
# inl devices: inl-rtds73, inl-rtds74, inl-rtds83, inl-rtds84
# remote nodes: csu-villas, usc-villas, nrel-rtds, acs-villas
#


############     nodes    ############

stats = 5.0;

nodes = {

	# ss1-ss2 (inl-rwth)
	inl-rtds73 = {
		type = "socket";
		layer = "udp";
		format = "gtnet";
		local  = "*:12073";
		remote = "141.221.118.73:12073";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss1-ss4 (inl-csu)
	inl-rtds84 = {
		type = "socket";
		layer = "udp";
		format = "gtnet";
		local  = "*:12084";
		remote = "141.221.118.84:12084";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss1-ss5 (inl-nrel)
	inl-rtds83 = {
		type = "socket";
		layer = "udp";
		format = "gtnet";
		local  = "*:12083";
		remote = "141.221.118.83:12083";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss1-ss7 (inl-usc)
	inl-rtds74 = {
		type = "socket";
		layer = "udp";
		format = "gtnet";
		local  = "*:12074";
		remote = "141.221.118.74:12074";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	}

	inl-opal = {
		type = "socket",
		layer = "udp",
		local  = "*:12009";
		remote = "141.221.118.109:12009";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	}

	# ss2 (in demo schematic)
	acs-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12002";
		remote = "10.10.15.1:12002";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss4 (in demo schematic)
	csu-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12004";
		remote = "129.82.106.227:12004";
		#remote = "10.10.15.1:12004";  # test with acs-opal
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss5 (in demo schematic)
	nrel-rtds = {
		type = "socket";
		layer = "udp";
		format = "gtnet";
		local  = "*:12005";
		remote = "192.174.56.96:12005";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss6 (in demo schematic)
	snl-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12006";
		remote = "10.1.2.4:12006";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss7 (in demo schematic)
	#we have to use two nodes and different ports for usc (some weird behavior of VPN/Firewall)
	inl-to-usc-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12007";
		remote = "129.252.22.104:13007";  #TODO: the idea is to use ports > 13000 for inl-web, take care to avoid conflict
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	usc-to-inl-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12077";
		remote = "129.252.22.104:13077";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# ss8 (in demo schematic)
	wsu-villas = {
		type = "socket";
		layer = "udp";
		local  = "*:12008";
		remote = "192.168.1.188:12008";
		hooks = (
			{
				type = "stats",
				warmup = 3000,
			}
		)
	},

	# Loopbacks for downsampling monitoring data
	loopback1 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 50
			}
		)
	},

	loopback2 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	loopback3 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	loopback4 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	loopback5 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	loopback6 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	loopback7 = {
		type = "loopback"
		hooks = (
			{
				type = "decimate",
				ratio = 100
			}
		)
	},

	# inl-villas-web endpoints for monitoring
	inl-villas-web-ss5 = {
		type = "socket",
		local = "*:13005",
		remote = "141.221.118.94:13005",
	}

	inl-villas-web-rtds73 = {
		type = "socket",
		local = "*:13073",
		remote = "141.221.118.94:13073",
	}

	inl-villas-web-rtds74 = {
		type = "socket",
		local = "*:13074",
		remote = "141.221.118.94:13074",
	}

	inl-villas-web-rtds83 = {
		type = "socket",
		local = "*:13083",
		remote = "141.221.118.94:13083",
	}

	inl-villas-web-rtds84 = {
		type = "socket",
		local = "*:13084",
		remote = "141.221.118.94:13084",
	}

	# Result recording
	results-ss2_ss9 = {
		type = "file",
		uri = "/rtsuperlab/IntegrationTesting/IntegrationTesting_0921/ss1ss2ss9_inl-csu_%Y%m%d_%H-%M-%S.csv", # start the file name with ssN (id of subsystem that DRTS in your labsimulates)
	},

	results-ss4_ss8 = {
		type = "file",
		uri = "/rtsuperlab/IntegrationTesting/IntegrationTesting_0921/ss1ss4ss8_inl-csu_%Y%m%d_%H-%M-%S.csv", # start the file name with ssN (id of subsystem that DRTS in your labsimulates)
	},

	results-ss5 = {
		type = "file",
		uri = "/rtsuperlab/IntegrationTesting/IntegrationTesting_0921/ss1ss5_inl-nrel_%Y%m%d_%H-%M-%S.csv", # start the file name with ssN (id of subsystem that DRTS in your labsimulates)
	},

	results-ss7_ss6 = {
		type = "file",
		uri = "/rtsuperlab/IntegrationTesting/IntegrationTesting_0921/ss1ss7ss6_inl-usc_%Y%m%d_%H-%M-%S.csv", # start the file name with ssN (id of subsystem that DRTS in your labsimulates)
	}
};


############     paths    ############

paths = (

	# ss1-ss2 (inl-rwth) co-simulation interface
	# ss1-ss9 (inl-opal)  co-simulation interface
	{
		in  = [
			"inl-rtds73"
		],
		out = [
			"acs-villas",
			"inl-opal",
			"results-ss2_ss9",
			"loopback1"
		],
	},
	{
		in  = [
			"loopback1"
		],
		out = [
			"inl-villas-web-rtds73"
		]
	},
	{
		in  = [
			"acs-villas.data[0-19]",
			"inl-opal.data[0-19]"
		],
		out = [
			"inl-rtds73"
		],
	},

	# ss1-ss7 (inl-usc) co-simulation interface
	# ss1-ss6 (inl-snl) co-simulation interface
	{
		in  = [
			"inl-rtds74"
		],
		out = [
			"inl-to-usc-villas",
			"snl-villas",
			"results-ss7_ss6",
			"loopback5"
		],
	},
	{
		in  = [
			"loopback5"
		],
		out = [
			"inl-villas-web-rtds74"
		]
	},
	{
		in  = [
			"usc-to-inl-villas.data[0-19]",
			"snl-villas.data[0-19]"
		],
		out = [
			"inl-rtds74"
		],
	},


	# ss1-ss5 (inl-nrel) co-simulation interface
	{
		in  = [
			"inl-rtds83"
		],
		out = [
			"nrel-rtds",
			"results-ss5",
			"loopback4"
		]
	},
	{
		in  = [
			"loopback4"
		],
		out = [
			"inl-villas-web-rtds83"
		]
	},
	{
		in  = [
			"nrel-rtds"
		],
		out = [
			"inl-rtds83",
			"loopback1"
		],
	},
	{
		in  = [
			"loopback1"
		],
		out = [
			"inl-villas-web-ss5"
		]
	},

	# ss1-ss4 (inl-csu) co-simulation interface
	# ss1-ss8 (inl-wsu) co-simulation interface
	{
		in  = [
			"inl-rtds84"
		],
		out = [
			"csu-villas",
			"wsu-villas",
			"results-ss4_ss8",
			"loopback3"
		],
	},
	{
		in  = [
			"loopback3"
		],
		out = [
			"inl-villas-web-rtds84"
		]
	},
	{
		in  = [
			"csu-villas.data[0-19]",
			"wsu-villas.data[0-19]"
		],
		out = [
			"inl-rtds84"
		],
	}
);
